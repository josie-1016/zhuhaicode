(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-27f504dc"],{a185:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",{attrs:{title:"属性审批"}},[t.attributes.length?a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.attributes}},[a("el-table-column",{attrs:{prop:"isPublic",label:"",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.isPublic?"公开":"私有")+" ")]}}],null,!1,2581177575)}),a("el-table-column",{attrs:{prop:"status",label:"类型",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.applyType)+" ")]}}],null,!1,4286698161)}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"attrName",label:"属性名"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"fromUid",label:"申请人"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"remark",label:"申请备注"}}),a("el-table-column",{attrs:{label:"操作",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(a){return t.revoke(e.row)}}},[t._v(" 撤销 ")]),a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){return t.agree(e.row,!0)}}},[t._v(" 同意 ")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.agree(e.row,!1)}}},[t._v(" 拒绝 ")])]}}],null,!1,2738409261)}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"100",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t.statusTypes[e.row.status],size:"small"}},[t._v(" "+t._s(e.row.status)+" ")])]}}],null,!1,3402781693)})],1)],1):a("el-empty",{attrs:{"image-size":100,description:"暂无待审批的属性"}})],1),a("el-dialog",{attrs:{title:"属性审批",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{attrs:{model:t.form,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.approval}},[t._v("确 定")])],1)],1)],1)},o=[],s=a("cc39"),n=(a("bdf9"),a("2646"),a("1a55"),a("0721"),a("7fa7"),a("042e"),a("ee64"),a("106c"),a("ae8d")),l=a("f8ce"),i=a("07a4"),u={name:"Approvals",components:{Card:n["a"]},mounted:function(){var t=this,e=i["a"].properties(["OPKMap","name"]),a=e.OPKMap,r=e.name,o=[{to:r,role:0}];Object.keys(a).map((function(t){o.push({to:t,role:1})}));var s="ALL";this.queryWithStatus(o,s).then((function(e){t.attributes=e}))},data:function(){return{attributes:[],form:{remark:""},params:{},dialogFormVisible:!1,statusTypes:{SUCCESS:"success",FAIL:"danger",PENDING:"pending",REVOKE:"revoke"}}},methods:{queryWithStatus:function(t,e){var a=[];return new Promise((function(r,o){Promise.all(t.map((function(t){var a=t.to,r=t.role;return l["a"].applications({to:a,role:r,status:e})}))).then((function(t){t.forEach((function(t){a=a.concat(t)})),r(a)})).catch(o)}))},agree:function(t,e){var a=i["a"].userName(),r=t.attrName,o=t.fromUid;this.params={to:o,agree:e,attr:r,user:a},this.dialogFormVisible=!0},approval:function(){var t=this;l["a"].approval(Object(s["a"])(Object(s["a"])({},this.params),this.form)).then((function(){t.$message({message:"审批成功",duration:2e3,type:"success"})})).catch((function(e){t.$message({message:e.message,duration:2e3,type:"error"})})).finally((function(){t.dialogFormVisible=!1}))},revoke:function(t){var e=this,a=i["a"].userName(),r=t.attrName,o=t.fromUid;l["a"].revoke({userName:a,toUserName:o,attrName:r}).then((function(){e.$message({message:"撤销成功",duration:2e3,type:"success"})})).catch((function(t){e.$message({message:t.message,duration:2e3,type:"error"})}))}}},c=u,p=a("52e0"),m=Object(p["a"])(c,r,o,!1,null,null,null);e["default"]=m.exports},ae8d:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card"},[t.title?a("div",{staticClass:"card-head"},[t._v(" "+t._s(t.title)+" "),a("div",{staticStyle:{float:"right"}},[t._t("op")],2)]):t._e(),t._t("default")],2)},o=[],s={name:"Card",props:{title:{type:String,default:""}}},n=s,l=(a("e24e"),a("52e0")),i=Object(l["a"])(n,r,o,!1,null,"88a16ad0",null);e["a"]=i.exports},e24e:function(t,e,a){"use strict";a("e826")},e826:function(t,e,a){}}]);
//# sourceMappingURL=chunk-27f504dc.aebb4f9f.js.map