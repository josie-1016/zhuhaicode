{"version":3,"sources":["webpack:///./src/views/certificates/_List.vue","webpack:///./src/api/certificates.js","webpack:///src/views/certificates/_List.vue","webpack:///./src/views/certificates/_List.vue?5941","webpack:///./src/views/certificates/_List.vue?2968","webpack:///./src/views/certificates/_List.vue?b1a6"],"names":["render","_vm","this","_c","_self","staticClass","attrs","model","value","searchInput","callback","$$v","expression","on","searchCert","_v","$event","applyFormVisible","certificates","emptyText","scopedSlots","_u","key","fn","scope","revoke","detailInfo","row","detailVisible","_s","detail","version","ABSUID","serialNumber","ABSAttribute","issuer","signatureName","validityPeriod","slot","ref","applyRules","applyCert","uid","$set","attribute","applyRes","_e","applyForCert","staticRenderFns","CERT_HOST","certService","axios","create","baseURL","interceptors","request","use","config","headers","crossdomain","error","console","log","Promise","reject","certApi","list","resolve","url","method","then","response","status","data","catch","no","params","certInfo","apply","name","components","required","trigger","message","mounted","res","map","item","JSON","parse","certificate","absSignature","methods","cert","$message","duration","type","splice","$index","e","$refs","applyForm","validate","valid","a","component"],"mappings":"uHAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,YAAY,WAAW,CAACF,EAAG,MAAM,CAACE,YAAY,OAAO,CAACF,EAAG,MAAM,CAACE,YAAY,YAAY,CAACF,EAAG,WAAW,CAACG,MAAM,CAAC,YAAc,QAAQC,MAAM,CAACC,MAAOP,EAAIQ,YAAaC,SAAS,SAAUC,GAAMV,EAAIQ,YAAYE,GAAKC,WAAW,kBAAkB,GAAGT,EAAG,MAAM,CAACA,EAAG,YAAY,CAACU,GAAG,CAAC,MAAQZ,EAAIa,aAAa,CAACb,EAAIc,GAAG,YAAYZ,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,WAAWO,GAAG,CAAC,MAAQ,SAASG,GAAQf,EAAIgB,kBAAmB,KAAQ,CAAChB,EAAIc,GAAG,aAAa,KAAKZ,EAAG,WAAW,CAACG,MAAM,CAAC,KAAOL,EAAIiB,aAAa,aAAajB,EAAIkB,YAAY,CAAChB,EAAG,kBAAkB,CAACG,MAAM,CAAC,wBAAwB,GAAG,MAAQ,OAAO,KAAO,YAAYH,EAAG,kBAAkB,CAACG,MAAM,CAAC,wBAAwB,GAAG,MAAQ,OAAO,KAAO,kBAAkBH,EAAG,kBAAkB,CAACG,MAAM,CAAC,MAAQ,KAAK,MAAQ,SAASc,YAAYnB,EAAIoB,GAAG,CAAC,CAACC,IAAI,UAAUC,GAAG,SAASC,GAAO,MAAO,CAACrB,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,OAAO,KAAO,UAAU,MAAQ,IAAIO,GAAG,CAAC,MAAQ,SAASG,GAAQ,OAAOf,EAAIwB,OAAOD,MAAU,CAACvB,EAAIc,GAAG,YAAYZ,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,OAAO,KAAO,QAAQO,GAAG,CAAC,MAAQ,SAASG,GAAQ,OAAOf,EAAIyB,WAAWF,EAAMG,QAAQ,CAAC1B,EAAIc,GAAG,oBAAoB,GAAGZ,EAAG,YAAY,CAACG,MAAM,CAAC,MAAQ,OAAO,QAAUL,EAAI2B,eAAef,GAAG,CAAC,iBAAiB,SAASG,GAAQf,EAAI2B,cAAcZ,KAAU,CAACb,EAAG,kBAAkB,CAACG,MAAM,CAAC,OAAS,IAAI,CAACH,EAAG,uBAAuB,CAACG,MAAM,CAAC,MAAQ,OAAO,CAACL,EAAIc,GAAGd,EAAI4B,GAAG5B,EAAI6B,OAAOC,YAAY5B,EAAG,uBAAuB,CAACG,MAAM,CAAC,MAAQ,OAAO,CAACL,EAAIc,GAAGd,EAAI4B,GAAG5B,EAAI6B,OAAOE,QAAQ,OAAO7B,EAAG,uBAAuB,CAACG,MAAM,CAAC,MAAQ,SAAS,CAACL,EAAIc,GAAG,IAAId,EAAI4B,GAAG5B,EAAI6B,OAAOG,cAAc,OAAO9B,EAAG,uBAAuB,CAACG,MAAM,CAAC,MAAQ,OAAO,CAACL,EAAIc,GAAG,IAAId,EAAI4B,GAAG5B,EAAI6B,OAAOI,cAAc,OAAO/B,EAAG,uBAAuB,CAACG,MAAM,CAAC,MAAQ,QAAQ,CAACL,EAAIc,GAAGd,EAAI4B,GAAG5B,EAAI6B,OAAOK,WAAWhC,EAAG,uBAAuB,CAACG,MAAM,CAAC,MAAQ,OAAO,CAACL,EAAIc,GAAGd,EAAI4B,GAAG5B,EAAI6B,OAAOM,kBAAkBjC,EAAG,uBAAuB,CAACG,MAAM,CAAC,MAAQ,QAAQ,CAACL,EAAIc,GAAGd,EAAI4B,GAAG5B,EAAI6B,OAAOO,oBAAoB,GAAGlC,EAAG,MAAM,CAACG,MAAM,CAAC,KAAO,UAAUgC,KAAK,UAAU,CAACnC,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,WAAWO,GAAG,CAAC,MAAQ,SAASG,GAAQf,EAAI2B,eAAgB,KAAS,CAAC3B,EAAIc,GAAG,UAAU,IAAI,GAAGZ,EAAG,YAAY,CAACG,MAAM,CAAC,MAAQ,OAAO,QAAUL,EAAIgB,kBAAkBJ,GAAG,CAAC,iBAAiB,SAASG,GAAQf,EAAIgB,iBAAiBD,KAAU,CAACb,EAAG,UAAU,CAACoC,IAAI,YAAYjC,MAAM,CAAC,MAAQL,EAAIuC,WAAW,MAAQvC,EAAIwC,UAAU,cAAc,SAAS,CAACtC,EAAG,eAAe,CAACG,MAAM,CAAC,KAAO,MAAM,MAAQ,QAAQ,CAACH,EAAG,WAAW,CAACI,MAAM,CAACC,MAAOP,EAAIwC,UAAUC,IAAKhC,SAAS,SAAUC,GAAMV,EAAI0C,KAAK1C,EAAIwC,UAAW,MAAO9B,IAAMC,WAAW,oBAAoB,GAAGT,EAAG,eAAe,CAACG,MAAM,CAAC,KAAO,YAAY,MAAQ,OAAO,CAACH,EAAG,WAAW,CAACI,MAAM,CAACC,MAAOP,EAAIwC,UAAUG,UAAWlC,SAAS,SAAUC,GAAMV,EAAI0C,KAAK1C,EAAIwC,UAAW,YAAa9B,IAAMC,WAAW,0BAA0B,GAAIX,EAAI4C,SAAU1C,EAAG,MAAM,CAACA,EAAG,eAAe,CAACG,MAAM,CAAC,KAAO,OAAO,MAAQ,OAAO,CAACL,EAAIc,GAAGd,EAAI4B,GAAG5B,EAAI4C,SAASd,YAAY5B,EAAG,eAAe,CAACG,MAAM,CAAC,KAAO,OAAO,MAAQ,OAAO,CAACL,EAAIc,GAAGd,EAAI4B,GAAG5B,EAAI4C,SAASb,QAAQ,OAAO7B,EAAG,eAAe,CAACG,MAAM,CAAC,KAAO,OAAO,MAAQ,SAAS,CAACL,EAAIc,GAAG,IAAId,EAAI4B,GAAG5B,EAAI4C,SAASZ,cAAc,OAAO9B,EAAG,eAAe,CAACG,MAAM,CAAC,KAAO,OAAO,MAAQ,OAAO,CAACL,EAAIc,GAAG,IAAId,EAAI4B,GAAG5B,EAAI4C,SAASX,cAAc,OAAO/B,EAAG,eAAe,CAACG,MAAM,CAAC,KAAO,OAAO,MAAQ,QAAQ,CAACL,EAAIc,GAAGd,EAAI4B,GAAG5B,EAAI4C,SAASV,WAAWhC,EAAG,eAAe,CAACG,MAAM,CAAC,KAAO,OAAO,MAAQ,OAAO,CAACL,EAAIc,GAAGd,EAAI4B,GAAG5B,EAAI4C,SAAST,kBAAkBjC,EAAG,eAAe,CAACG,MAAM,CAAC,KAAO,OAAO,MAAQ,QAAQ,CAACL,EAAIc,GAAGd,EAAI4B,GAAG5B,EAAI4C,SAASR,oBAAoB,GAAGpC,EAAI6C,MAAM,GAAG3C,EAAG,MAAM,CAACG,MAAM,CAAC,KAAO,UAAUgC,KAAK,UAAU,CAACnC,EAAG,YAAY,CAACU,GAAG,CAAC,MAAQ,SAASG,GAAQf,EAAIgB,kBAAmB,KAAS,CAAChB,EAAIc,GAAG,SAASZ,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,WAAWO,GAAG,CAAC,MAAQZ,EAAI8C,eAAe,CAAC9C,EAAIc,GAAG,UAAU,IAAI,IAAI,IAEvxHiC,EAAkB,G,qBCAtB,MAAMC,EAAY,SACZC,EAAcC,IAAMC,OAAO,CAC7BC,QAA4DJ,IAIhEC,EAAYI,aAAaC,QAAQC,IAC7BC,IACIA,EAAOC,QAAQ,+BAAiC,IAChDD,EAAOC,QAAQ,gCAAkC,yCACjDD,EAAOC,QAAQ,gCAAkC,qCACjDD,EAAOE,aAAc,EACdF,GAEXG,IAEIC,QAAQC,IAAI,kBAAmBF,GACxBG,QAAQC,OAAOJ,KAIvB,MAAMK,EAAU,CAMnBC,KAAM,WACF,OAAO,IAAIH,QAAQ,CAACI,EAASH,KACzBd,EAAYK,QAAQ,CAChBa,IAAK,cACLC,OAAQ,QACTC,KAAKC,IACoB,MAApBA,EAASC,OACTL,EAAQI,EAASE,MAGjBT,EAAOO,KAEZG,MAAMV,MASjBvC,OAAQ,UAAU,GAAEkD,IAChB,OAAO,IAAIZ,QAAQ,CAACI,EAASH,KACzBd,EAAYK,QAAQ,CAChBa,IAAK,wBACLC,OAAQ,MACRO,OAAQ,CAAED,QACXL,KAAKC,IACoB,MAApBA,EAASC,OACTL,EAAQI,EAASE,MAGjBT,EAAOO,KAEZG,MAAMV,MASjBa,SAAU,SAAUnC,GAChB,OAAO,IAAIqB,QAAQ,CAACI,EAASH,KACzBd,EAAYK,QAAQ,CAChBa,IAAK,uBACLC,OAAQ,MACRO,OAAQ,CAAClC,SACV4B,KAAKC,IACoB,MAApBA,EAASC,OACTL,EAAQI,EAASE,MAGjBT,EAAOO,KAEZG,MAAMV,MASjBc,MAAO,SAAUpC,EAAKE,GAClB,OAAO,IAAImB,QAAQ,CAACI,EAASH,KACzBd,EAAYK,QAAQ,CAChBa,IAAK,0BACLC,OAAQ,MACRO,OAAQ,CAAClC,MAAKE,eACf0B,KAAKC,IACoB,MAApBA,EAASC,OACTL,EAAQI,EAASE,MAGjBT,EAAOO,KAEZG,MAAMV,OCtCN,OACfe,KAAA,OACAC,WAAA,GACAP,OACA,OACAvD,aAAA,GACAC,UAAA,OACAS,eAAA,EACAE,OAAA,GAEAb,kBAAA,EACAwB,UAAA,GAEAD,WAAA,CACAE,IAAA,EAAAuC,UAAA,EAAAC,QAAA,OAAAC,QAAA,aACAvC,UAAA,EAAAqC,UAAA,EAAAC,QAAA,OAAAC,QAAA,YAGA1E,YAAA,GACAoC,UAAA,IAIAuC,UACA,KAAAjE,UAAA,UACA8C,EACAC,OACAI,KAAAe,IACA,KAAAnE,aAAAmE,EAAAC,IAAAC,IACAA,EAAAC,KAAAC,MAAAF,GACAA,EAAAG,YAAA,gBAAAH,EAAAI,aACAJ,EAAAG,cAEA,KAAAvE,UAAA,SAEAuD,MAAAb,QAAAC,MAGA8B,QAAA,CACAlE,WAAAmE,GACA,KAAAjE,eAAA,EACA,KAAAE,OAAA+D,GAGApE,OAAAD,GACA,MAAAmD,EAAAnD,EAAAG,IAAAM,aACAgC,EACAxC,OAAA,CAAAkD,OACAL,KAAAe,IACA,QAAAA,GACA,KAAAS,SAAA,CACAX,QAAA,OACAY,SAAA,IACAC,KAAA,YAEA,KAAA9E,aAAA+E,OAAAzE,EAAA0E,OAAA,IAEA,KAAAJ,SAAA,CACAX,QAAAE,EACAW,KAAA,YAIAtB,MAAAyB,IACA,KAAAL,SAAA,CACAX,QAAAgB,EAAAhB,QACAa,KAAA,aAKAjD,eACA,KAAAqD,MAAAC,UAAAC,SAAAC,IACA,IAAAA,EAAA,OACA,UAAA7D,EAAA,UAAAE,GAAA,KAAAH,UACA,KAAAI,UAAA,EAEAoB,EACAa,MAAApC,EAAAE,GACA0B,KAAAiB,IACAA,EAAAG,YAAA,gBAAAH,EAAAI,aACA,KAAA9C,SAAA0C,EAAAG,YACA,KAAAI,SAAA,CACAX,QAAA,OACAY,SAAA,IACAC,KAAA,cAGAtB,MAAAyB,IACA,KAAAL,SAAA,CACAX,QAAAgB,EAAAhB,QACAa,KAAA,eAMAlF,aACA,MAAA0F,EAAA,KAAA/F,YACA+F,GACAvC,EACAY,SAAA2B,GACAlC,KAAAiB,IACAA,EAAAG,YAAA,gBAAAH,EAAAI,aACA,KAAAzE,aAAA,CAAAqE,EAAAG,eAEAhB,MAAAyB,IACA,KAAAL,SAAA,CACAX,QAAAgB,EAAAhB,QACAa,KAAA,eClL8V,I,wBCQ1VS,EAAY,eACd,EACAzG,EACAgD,GACA,EACA,KACA,WACA,MAIa,aAAAyD,E,2CCnBf,W","file":"js/chunk-6fe3dc80.4db0c4f8.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"content\"},[_c('div',{staticClass:\"wer\"},[_c('div',{staticClass:\"wer-left\"},[_c('el-input',{attrs:{\"placeholder\":\"设备名称\"},model:{value:(_vm.searchInput),callback:function ($$v) {_vm.searchInput=$$v},expression:\"searchInput\"}})],1),_c('div',[_c('el-button',{on:{\"click\":_vm.searchCert}},[_vm._v(\" 查询证书 \")]),_c('el-button',{attrs:{\"type\":\"success\"},on:{\"click\":function($event){_vm.applyFormVisible = true}}},[_vm._v(\" 证书申请 \")])],1)]),_c('el-table',{attrs:{\"data\":_vm.certificates,\"empty-text\":_vm.emptyText}},[_c('el-table-column',{attrs:{\"show-overflow-tooltip\":\"\",\"label\":\"设备名称\",\"prop\":\"ABSUID\"}}),_c('el-table-column',{attrs:{\"show-overflow-tooltip\":\"\",\"label\":\"证书序号\",\"prop\":\"serialNumber\"}}),_c('el-table-column',{attrs:{\"label\":\"操作\",\"align\":\"right\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"warning\",\"plain\":\"\"},on:{\"click\":function($event){return _vm.revoke(scope)}}},[_vm._v(\" 撤销证书 \")]),_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"info\"},on:{\"click\":function($event){return _vm.detailInfo(scope.row)}}},[_vm._v(\" 详细信息 \")])]}}])})],1),_c('el-dialog',{attrs:{\"title\":\"详细信息\",\"visible\":_vm.detailVisible},on:{\"update:visible\":function($event){_vm.detailVisible=$event}}},[_c('el-descriptions',{attrs:{\"column\":1}},[_c('el-descriptions-item',{attrs:{\"label\":\"版本\"}},[_vm._v(_vm._s(_vm.detail.version))]),_c('el-descriptions-item',{attrs:{\"label\":\"设备\"}},[_vm._v(_vm._s(_vm.detail.ABSUID)+\" \")]),_c('el-descriptions-item',{attrs:{\"label\":\"证书序号\"}},[_vm._v(\" \"+_vm._s(_vm.detail.serialNumber)+\" \")]),_c('el-descriptions-item',{attrs:{\"label\":\"标签\"}},[_vm._v(\" \"+_vm._s(_vm.detail.ABSAttribute)+\" \")]),_c('el-descriptions-item',{attrs:{\"label\":\"签名人\"}},[_vm._v(_vm._s(_vm.detail.issuer))]),_c('el-descriptions-item',{attrs:{\"label\":\"签名\"}},[_vm._v(_vm._s(_vm.detail.signatureName))]),_c('el-descriptions-item',{attrs:{\"label\":\"优先级\"}},[_vm._v(_vm._s(_vm.detail.validityPeriod))])],1),_c('div',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.detailVisible = false}}},[_vm._v(\"确 定\")])],1)],1),_c('el-dialog',{attrs:{\"title\":\"证书申请\",\"visible\":_vm.applyFormVisible},on:{\"update:visible\":function($event){_vm.applyFormVisible=$event}}},[_c('el-form',{ref:\"applyForm\",attrs:{\"rules\":_vm.applyRules,\"model\":_vm.applyCert,\"label-width\":\"80px\"}},[_c('el-form-item',{attrs:{\"prop\":\"uid\",\"label\":\"UID\"}},[_c('el-input',{model:{value:(_vm.applyCert.uid),callback:function ($$v) {_vm.$set(_vm.applyCert, \"uid\", $$v)},expression:\"applyCert.uid\"}})],1),_c('el-form-item',{attrs:{\"prop\":\"attribute\",\"label\":\"标签\"}},[_c('el-input',{model:{value:(_vm.applyCert.attribute),callback:function ($$v) {_vm.$set(_vm.applyCert, \"attribute\", $$v)},expression:\"applyCert.attribute\"}})],1),(_vm.applyRes)?_c('div',[_c('el-form-item',{attrs:{\"size\":\"mini\",\"label\":\"版本\"}},[_vm._v(_vm._s(_vm.applyRes.version))]),_c('el-form-item',{attrs:{\"size\":\"mini\",\"label\":\"设备\"}},[_vm._v(_vm._s(_vm.applyRes.ABSUID)+\" \")]),_c('el-form-item',{attrs:{\"size\":\"mini\",\"label\":\"证书序号\"}},[_vm._v(\" \"+_vm._s(_vm.applyRes.serialNumber)+\" \")]),_c('el-form-item',{attrs:{\"size\":\"mini\",\"label\":\"标签\"}},[_vm._v(\" \"+_vm._s(_vm.applyRes.ABSAttribute)+\" \")]),_c('el-form-item',{attrs:{\"size\":\"mini\",\"label\":\"签名人\"}},[_vm._v(_vm._s(_vm.applyRes.issuer))]),_c('el-form-item',{attrs:{\"size\":\"mini\",\"label\":\"签名\"}},[_vm._v(_vm._s(_vm.applyRes.signatureName))]),_c('el-form-item',{attrs:{\"size\":\"mini\",\"label\":\"优先级\"}},[_vm._v(_vm._s(_vm.applyRes.validityPeriod))])],1):_vm._e()],1),_c('div',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.applyFormVisible = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.applyForCert}},[_vm._v(\"申 请\")])],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import axios from 'axios'\n\nconst CERT_HOST = \"/dpki/\"\nconst certService = axios.create({\n    baseURL: process.env.NODE_ENV === \"development\" ? '/cert' : CERT_HOST,\n})\n\n// request interceptor\ncertService.interceptors.request.use(\n    config => {\n        config.headers['Access-Control-Allow-Origin'] = \"*\"\n        config.headers['Access-Control-Allow-Methods'] = \"GET, POST, PATCH, PUT, DELETE, OPTIONS\"\n        config.headers['Access-Control-Allow-Headers'] = \"Origin, Content-Type, X-Auth-Token\"\n        config.crossdomain = true\n        return config\n    },\n    error => {\n        // do something with request error\n        console.log('[request error]', error)\n        return Promise.reject(error)\n    }\n)\n\nexport const certApi = {\n    /**\n     * 获取证书列表\n     * @param {*} _data \n     * @returns Promise\n     */\n    list: function () {\n        return new Promise((resolve, reject) => {\n            certService.request({\n                url: '/IoTDevTest',\n                method: 'get',\n            }).then(response => {\n                if (response.status === 200) {\n                    resolve(response.data)\n                }\n                else {\n                    reject(response)\n                }\n            }).catch(reject)\n        })\n    },\n\n    /**\n     * 撤销证书\n     * @param {*} _data \n     * @returns Promise\n     */\n    revoke: function ({ no }) {\n        return new Promise((resolve, reject) => {\n            certService.request({\n                url: '/RevokeABSCertificate',\n                method: 'get',\n                params: { no }\n            }).then(response => {\n                if (response.status === 200) {\n                    resolve(response.data)\n                }\n                else {\n                    reject(response)\n                }\n            }).catch(reject)\n        })\n    },\n\n    /**\n     * 查询证书详细信息\n     * @param {*} _data \n     * @returns Promise\n     */\n    certInfo: function (uid) {\n        return new Promise((resolve, reject) => {\n            certService.request({\n                url: '/GetCertificateByUID',\n                method: 'get',\n                params: {uid}\n            }).then(response => {\n                if (response.status === 200) {\n                    resolve(response.data)\n                }\n                else {\n                    reject(response)\n                }\n            }).catch(reject)\n        })\n    },\n\n    /**\n     * 申请证书\n     * @param {*} _data \n     * @returns Promise\n     */\n    apply: function (uid, attribute) {\n        return new Promise((resolve, reject) => {\n            certService.request({\n                url: '/ApplyForABSCertificate',\n                method: 'get',\n                params: {uid, attribute}\n            }).then(response => {\n                if (response.status === 200) {\n                    resolve(response.data)\n                }\n                else {\n                    reject(response)\n                }\n            }).catch(reject)\n        })\n    }\n}","<template>\n  <div class=\"content\">\n    <div class=\"wer\">\n      <div class=\"wer-left\">\n        <el-input placeholder=\"设备名称\" v-model=\"searchInput\" />\n      </div>\n      <div>\n        <el-button @click=\"searchCert\"> 查询证书 </el-button>\n        <el-button type=\"success\" @click=\"applyFormVisible = true\"> 证书申请 </el-button>\n      </div>\n    </div>\n\n    <el-table :data=\"certificates\" :empty-text=\"emptyText\">\n      <el-table-column show-overflow-tooltip label=\"设备名称\" prop=\"ABSUID\" />\n      <el-table-column show-overflow-tooltip label=\"证书序号\" prop=\"serialNumber\" />\n      <el-table-column label=\"操作\" align=\"right\">\n        <template slot-scope=\"scope\">\n          <el-button size=\"mini\" type=\"warning\" @click=\"revoke(scope)\" plain> 撤销证书 </el-button>\n          <el-button size=\"mini\" type=\"info\" @click=\"detailInfo(scope.row)\"> 详细信息 </el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <el-dialog title=\"详细信息\" :visible.sync=\"detailVisible\">\n      <el-descriptions :column=\"1\">\n        <el-descriptions-item label=\"版本\">{{ detail.version }}</el-descriptions-item>\n        <el-descriptions-item label=\"设备\">{{ detail.ABSUID }} </el-descriptions-item>\n        <el-descriptions-item label=\"证书序号\"> {{ detail.serialNumber }} </el-descriptions-item>\n        <el-descriptions-item label=\"标签\"> {{ detail.ABSAttribute }} </el-descriptions-item>\n        <el-descriptions-item label=\"签名人\">{{ detail.issuer }}</el-descriptions-item>\n        <el-descriptions-item label=\"签名\">{{ detail.signatureName }}</el-descriptions-item>\n        <el-descriptions-item label=\"优先级\">{{ detail.validityPeriod }}</el-descriptions-item>\n      </el-descriptions>\n\n      <div slot=\"footer\">\n        <el-button type=\"primary\" @click=\"detailVisible = false\">确 定</el-button>\n      </div>\n    </el-dialog>\n\n    <el-dialog title=\"证书申请\" :visible.sync=\"applyFormVisible\">\n      <el-form ref=\"applyForm\" :rules=\"applyRules\" :model=\"applyCert\" label-width=\"80px\">\n        <el-form-item prop=\"uid\" label=\"UID\">\n          <el-input v-model=\"applyCert.uid\"></el-input>\n        </el-form-item>\n        <el-form-item prop=\"attribute\" label=\"标签\">\n          <el-input v-model=\"applyCert.attribute\"></el-input>\n        </el-form-item>\n        <div v-if=\"applyRes\">\n          <el-form-item size=\"mini\" label=\"版本\">{{ applyRes.version }}</el-form-item>\n          <el-form-item size=\"mini\" label=\"设备\">{{ applyRes.ABSUID }} </el-form-item>\n          <el-form-item size=\"mini\" label=\"证书序号\"> {{ applyRes.serialNumber }} </el-form-item>\n          <el-form-item size=\"mini\" label=\"标签\"> {{ applyRes.ABSAttribute }} </el-form-item>\n          <el-form-item size=\"mini\" label=\"签名人\">{{ applyRes.issuer }}</el-form-item>\n          <el-form-item size=\"mini\" label=\"签名\">{{ applyRes.signatureName }}</el-form-item>\n          <el-form-item size=\"mini\" label=\"优先级\">{{ applyRes.validityPeriod }}</el-form-item>\n        </div>\n      </el-form>\n\n      <div slot=\"footer\">\n        <el-button @click=\"applyFormVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"applyForCert\">申 请</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { certApi } from \"@/api/certificates\";\n\nexport default {\n  name: \"List\",\n  components: {},\n  data() {\n    return {\n      certificates: [],\n      emptyText: \"暂无数据\",\n      detailVisible: false,\n      detail: {},\n\n      applyFormVisible: false,\n      applyCert: {},\n\n      applyRules: {\n        uid: [{ required: true, trigger: \"blur\", message: \"UID 不能为空\" }],\n        attribute: [{ required: true, trigger: \"blur\", message: \"标签不能为空\" }],\n      },\n\n      searchInput: \"\",\n      applyRes: false,\n    };\n  },\n\n  mounted() {\n    this.emptyText = \"正在加载...\";\n    certApi\n      .list()\n      .then((res) => {\n        this.certificates = res.map((item) => {\n          item = JSON.parse(item)\n          item.certificate[\"absSignature\"] = item.absSignature;\n          return item.certificate;\n        });\n        this.emptyText = \"暂无证书\";\n      })\n      .catch(console.log);\n  },\n\n  methods: {\n    detailInfo(cert) {\n      this.detailVisible = true;\n      this.detail = cert;\n    },\n\n    revoke(scope) {\n      const no = scope.row.serialNumber;\n      certApi\n        .revoke({ no })\n        .then((res) => {\n          if (res === \"OK.\") {\n            this.$message({\n              message: \"撤销成功\",\n              duration: 2 * 1000,\n              type: \"success\",\n            });\n            this.certificates.splice(scope.$index, 1);\n          } else {\n            this.$message({\n              message: res,\n              type: \"error\",\n            });\n          }\n        })\n        .catch((e) => {\n          this.$message({\n            message: e.message,\n            type: \"error\",\n          });\n        });\n    },\n\n    applyForCert() {\n      this.$refs.applyForm.validate((valid) => {\n        if (!valid) return;\n        const { uid, attribute } = this.applyCert;\n        this.applyRes = false;\n\n        certApi\n          .apply(uid, attribute)\n          .then((item) => {\n            item.certificate[\"absSignature\"] = item.absSignature;\n            this.applyRes = item.certificate;\n            this.$message({\n              message: \"申请成功\",\n              duration: 2 * 1000,\n              type: \"success\",\n            });\n          })\n          .catch((e) => {\n            this.$message({\n              message: e.message,\n              type: \"error\",\n            });\n          });\n      });\n    },\n\n    searchCert() {\n      const a = this.searchInput;\n      if (a) {\n        certApi\n          .certInfo(a)\n          .then((item) => {\n            item.certificate[\"absSignature\"] = item.absSignature;\n            this.certificates = [item.certificate];\n          })\n          .catch((e) => {\n            this.$message({\n              message: e.message,\n              type: \"error\",\n            });\n          });\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n.content {\n  padding: 16px;\n  background-color: var(--bg-color-0, white);\n}\n\n.wer {\n  display: flex;\n  gap: 16px;\n  padding: 8px 0;\n}\n\n.wer-left {\n  flex: 1;\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./_List.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./_List.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./_List.vue?vue&type=template&id=48a73b44&scoped=true&\"\nimport script from \"./_List.vue?vue&type=script&lang=js&\"\nexport * from \"./_List.vue?vue&type=script&lang=js&\"\nimport style0 from \"./_List.vue?vue&type=style&index=0&id=48a73b44&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"48a73b44\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./_List.vue?vue&type=style&index=0&id=48a73b44&prod&scoped=true&lang=css&\""],"sourceRoot":""}